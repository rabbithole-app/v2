<hlm-dialog-header>
  <h3 hlmDialogTitle>Add Allowance</h3>
  <p hlmDialogDescription>
    Grant permission to a spender to use your ICP tokens.
  </p>
</hlm-dialog-header>

<div class="mt-4 space-y-6">
  <!-- Spender ID Field -->
  <div hlmField orientation="responsive">
    <label hlmFieldLabel for="spenderId">Spender ID</label>
    <hlm-field-content>
      <input
        hlmInput
        id="spenderId"
        [field]="allowanceForm.spenderId"
        [attr.aria-invalid]="spenderIdError()"
        placeholder="Enter Principal ID"
      />
      <hlm-field-description>
        Principal ID of the spender.
      </hlm-field-description>
      @if (spenderIdError(); as error) {
        <hlm-field-error>
          {{ error }}
        </hlm-field-error>
      }
    </hlm-field-content>
  </div>

  <!-- Amount Field -->
  <div hlmField orientation="responsive">
    <label hlmFieldLabel for="amount">Amount (ICP)</label>
    <hlm-field-content>
      <input
        hlmInput
        id="amount"
        type="number"
        [field]="allowanceForm.amount"
        [attr.aria-invalid]="amountError()"
        placeholder="0.00"
        step="0.00000001"
      />
      <hlm-field-description>
        Maximum amount the spender can use (min: 0.00000001 ICP).
      </hlm-field-description>
      @if (amountError()) {
        <hlm-field-error>
          {{ amountError() }}
        </hlm-field-error>
      }
    </hlm-field-content>
  </div>

  <!-- Expires At Field (Optional) -->
  <div hlmField orientation="responsive">
    <label hlmFieldLabel for="expiresAt">Expires At</label>
    <hlm-field-content>
      <div class="flex items-center gap-2">
        <hlm-date-picker
          [date]="_selectedDate()"
          (dateChange)="_onDateChange($event)"
          [min]="minDate"
          [autoCloseOnSelect]="true"
          captionLayout="dropdown"
        >
          Select expiration date
        </hlm-date-picker>
        @if (_selectedDate()) {
          <button
            hlmInputGroupButton
            size="icon-xs"
            (click)="_onClearDate()"
            type="button"
          >
            <ng-icon hlm size="xs" name="lucideX" />
          </button>
        }
      </div>
      <hlm-field-description>
        Optional expiration date. Leave empty for no expiration.
      </hlm-field-description>
    </hlm-field-content>
  </div>
</div>

<hlm-dialog-footer class="mt-4">
  <button hlmBtn variant="outline" brnDialogClose>Cancel</button>
  <button hlmBtn [disabled]="isSubmitDisabled()" (click)="_handleAdd()">
    Add Allowance
  </button>
</hlm-dialog-footer>
