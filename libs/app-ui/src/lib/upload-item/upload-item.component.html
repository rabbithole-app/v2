<div class="flex gap-3 items-center">
  @let file = data().file;
  <ng-icon hlm class="opacity-60" size="lg" [name]="file | fileIcon" />
  <div class="flex-1 space-y-1">
    <div class="text-sm/6 font-bold">{{ file.name }}</div>
    <div class="flex items-center gap-1">
      <span class="text-muted-foreground text-xs">
        @let d = data(); @switch (d.status) { @case ('processing') {
        {{ d.current | formatRangeBytes : d.total }}
        }@default {
        {{ d.file.size | formatBytes }}
        } }
      </span>
      <span class="text-muted-foreground text-xs">âˆ™</span>
      <ng-container [ngTemplateOutlet]="statusIcon" />
      <ng-container [ngTemplateOutlet]="statusText" />
    </div>
  </div>
  <ng-container [ngTemplateOutlet]="actionButtons" />
</div>
@if (showProgress()) {
<brn-progress
  rbth
  class="w-full h-1.5 rounded-full"
  aria-labelledby="loading"
  [value]="progress()"
>
  <brn-progress-indicator rbth />
</brn-progress>
}

<ng-template #statusIcon>
  @let d = data(); @switch (d.status) { @case ('failed') {
  <ng-icon
    [rbthTooltipTrigger]="d.errorMessage"
    hlm
    size="sm"
    name="lucideTriangleAlert"
    aria-hidden="true"
  />
  } @case ('done') {
  <ng-icon hlm size="sm" name="lucideCheck" aria-hidden="true" />
  } @default {
  <hlm-spinner size="xs" />
  } }
</ng-template>

<ng-template #statusText>
  <span class="text-xs ml-1 font-semibold">
    @let d = data(); @switch (d.status) { @case ('failed') { Failed } @case
    ('done') { Completed } @case ('pending') { Pending... } @default {
    Uploading... } }
  </span>
</ng-template>

<ng-template #actionButtons>
  @switch (data().status) { @case ('failed') {
  <ng-container [ngTemplateOutlet]="retryButton" />
  <ng-container [ngTemplateOutlet]="removeButton" />
  } @case ('calchash') {<ng-container
    [ngTemplateOutlet]="cancelButton"
  />}@case('processing') {
  <ng-container [ngTemplateOutlet]="cancelButton" />
  }@case('pending') {
  <ng-container [ngTemplateOutlet]="cancelButton" />
  } @case ('done') {
  <ng-container [ngTemplateOutlet]="removeButton" />
  } }
</ng-template>
<ng-template #retryButton>
  <button
    hlmBtn
    class="size-6! px-0!"
    size="icon"
    variant="ghost"
    aria-label="Retry upload"
    [rbthTooltipTrigger]="'Retry'"
    (click)="retryUpload.emit()"
  >
    <ng-icon hlm size="sm" name="lucideRotateCcw" aria-hidden="true" />
  </button>
</ng-template>
<ng-template #cancelButton>
  <button
    hlmBtn
    class="size-6! px-0!"
    size="icon"
    variant="ghost"
    [rbthTooltipTrigger]="'Cancel'"
    aria-label="Cancel upload"
    (click)="cancelUpload.emit()"
  >
    <ng-icon hlm size="sm" name="lucideX" aria-hidden="true" />
  </button>
</ng-template>
<ng-template #removeButton>
  <button
    hlmBtn
    class="size-6! px-0!"
    size="icon"
    variant="ghost"
    aria-label="Remove upload"
    [rbthTooltipTrigger]="'Remove'"
    (click)="removeUpload.emit()"
  >
    <ng-icon hlm size="sm" name="lucideTrash2" aria-hidden="true" />
  </button>
</ng-template>
